{% extends "base.html" %}

{% block content %}
  <section class="relative bg-gradient-to-r from-blue-600 to-blue-800 text-white py-16 overflow-hidden">
    <div class="absolute inset-0 pointer-events-none"
         style="background: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.15) 0%, transparent 60%);">
    </div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="text-5xl font-extrabold tracking-tight mb-4">
        {% trans %}Challenges{% endtrans %}
      </h1>

      <p class="text-lg opacity-95 font-medium max-w-2xl mx-auto">
        Explore all available challenges and test your cybersecurity skills
      </p>
    </div>
  </section>


  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div>
      <div>
        {% include "components/errors.html" %}
      </div>
    </div>

    <div 
      x-data="ChallengeBoard" 
      @load-challenges.window="loadChallenges()" 
      @load-challenge.window="loadChallenge($event.detail)"
    >
      <div
          x-ref="challengeWindow" id="challenge-window" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50" tabindex="-1" role="dialog" x-data=""
          x-html="$store.challenge.data.view"
      ></div>

      <div x-show="!loaded">
        <div class="min-h-screen flex items-center justify-center">
          <div class="text-center">
            <i class="fas fa-circle-notch fa-spin text-4xl text-gray-400"></i>
          </div>
        </div>
      </div>

      <div x-show="loaded">
        <template x-for="(category, idx) in getCategories()" :key="idx">
          <div class="py-8">
            <div class="mb-6">
              <h3 class="text-2xl font-bold text-gray-900 inline-block px-4 py-3 rounded-lg 
                         bg-gradient-to-r from-blue-100 to-blue-50 border-l-4 border-blue-600 shadow-sm
                         hover:shadow-md transition-shadow"
                  x-text="category"></h3>
            </div>

            <div>
              <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <template x-for="(c, idx) in getChallenges(category)" :key="c.id">
                  <div>
                    <button
                        class="challenge-button w-full h-full bg-white hover:bg-blue-50 text-gray-900 rounded-lg p-4 transition-all duration-300 transform hover:scale-105 hover:shadow-lg hover:border-blue-500 border-2 border-gray-200"
                        :class="[
                          c.solved_by_me ? 'ring-2 ring-green-500 bg-green-50' : '',
                          ...c.tags.map((tag) => `tag-${tag.value.replace(/ /g, '-')}`),
                        ];"
                        :value="c.id" @click="loadChallenge(c.id)"
                    >

                      <div class="challenge-inner my-3">
                        <p class="font-bold text-lg" x-text="c.name"></p>
                        <span class="text-2xl font-extrabold text-blue-600" x-text="c.value"></span>
                      </div>
                    </button>
                  </div>
                </template>
              </div>
            </div>
          </div>
        </template>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ Assets.js("assets/js/challenges.js") }}
{% endblock %}